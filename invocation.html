<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invocation and Preamble - Covenant</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400&family=Crimson+Text:ital,wght@0,400;0,600;1,400&family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;0,700;1,400&display=block" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Symbols+2&display=block" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #8b7355;
            --text-color: #1a1a1a;
            --bg-color: #fafaf8;
            --sentence-highlight: #f0e3d4;
            --glyph-red: #8b2f2f;
            --glyph-gold: #c9a961;

            --footer-height: 70px;
            --footer-safe: env(safe-area-inset-bottom, 0px);
            --footer-total-height: calc(var(--footer-height) + var(--footer-safe));

            --footer-top: #6b5a4a;
            --footer-mid: #4a372b;
            --footer-bottom: #23160f;

            --footer-label: rgba(236, 216, 176, 0.78);
            --footer-label-hover: rgba(245, 217, 140, 0.96);

            --lexicon-frame-raise: 7px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            height: 100%;
            font-family: 'Lora', serif;
            background-color: #000;
            font-size: 16px;
            scroll-behavior: smooth;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.7;
            margin: 0 auto;
            padding: 40px 20px calc(var(--footer-height) + 40px + var(--footer-safe));
            min-height: 100vh;
            position: relative;
        }

        /* Scroll lock */
        html.lexicon-scroll-lock,
        body.lexicon-scroll-lock {
            overflow: hidden;
            height: 100%;
        }

        body.lexicon-scroll-lock {
            position: fixed;
            width: 100%;
            left: 0;
            right: 0;
        }

        /* Loading Overlay */
        #loadingIcon {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            color: var(--accent-color);
            z-index: 10001;
            animation: rotateGlyph 2s linear infinite;
            pointer-events: none;
            opacity: 1;
            transition: opacity 0.5s ease-out;
        }

        #loadingIcon.fade-out {
            opacity: 0;
        }

        @keyframes rotateGlyph {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }

        #blackFadeOverlay {
            position: fixed;
            inset: 0;
            background-color: #000;
            z-index: 10000;
            pointer-events: none;
            transition: opacity 1.5s ease-out;
        }

        #blackFadeOverlay.fade-out {
            opacity: 0;
        }

        /* Main Content Container */
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: var(--bg-color);
            padding: 60px;
            border-radius: 2px;
            opacity: 0;
            transition: opacity 1s ease-in;
        }

        .container.fade-in {
            opacity: 1;
        }

        /* Section Header */
        .section-header {
            text-align: center;
            margin-bottom: 50px;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 30px;
        }

        .ornament {
            font-size: 28px;
            letter-spacing: 12px;
            margin-bottom: 20px;
            color: var(--accent-color);
        }

        h1 {
            font-family: 'Crimson Text', serif;
            font-size: 2.5em;
            font-weight: 600;
            letter-spacing: 2px;
            margin: 20px 0;
            color: var(--primary-color);
            text-transform: uppercase;
        }

        /* Text Content */
        p {
            margin-bottom: 18px;
            text-align: justify;
            hyphens: none;
        }

        p.preamble {
            font-style: italic;
            color: #555;
            font-size: 0.95em;
        }

        .section-divider {
            text-align: center;
            color: var(--glyph-gold);
            font-size: 0.9rem;
            margin: 1rem 0;
            user-select: none;
        }

        /* Glossary Terms & Tooltips */
        .glossary-term {
            cursor: help;
            border-bottom: 1px dotted var(--accent-color);
            position: relative;
            color: var(--primary-color);
            font-weight: 500;
            transition: background-color 0.2s ease;
        }

        .glossary-term:hover {
            background-color: rgba(139, 115, 85, 0.1);
        }

        .glossary-ref {
            vertical-align: super;
            font-size: 0.75em;
            margin-left: 2px;
            color: var(--accent-color);
            font-weight: bold;
        }

        .tooltip {
            visibility: hidden;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--primary-color);
            color: white;
            text-align: center;
            padding: 10px 15px;
            border-radius: 4px;
            font-size: 0.85em;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            font-style: normal;
            font-weight: 400;
            max-width: 280px;
            line-height: 1.4;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: none;
        }

        .tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: var(--primary-color) transparent transparent transparent;
        }

        .glossary-term:hover .tooltip,
        .glossary-term.tooltip-active .tooltip {
            visibility: visible;
        }

        /* Sentence Selection */
        .sentence {
            cursor: pointer;
            transition: background-color 0.2s ease, box-shadow 0.2s ease;
        }

        .sentence.is-selected {
            background-color: var(--sentence-highlight);
            box-shadow: 0 0 0 1px rgba(139, 115, 85, 0.25);
        }

        .sentence-label {
            font-size: 0.7em;
            vertical-align: super;
            color: #b79a76;
            margin-right: 0.2em;
            user-select: none;
            transition: color 0.2s ease;
        }

        .sentence.is-selected .sentence-label {
            color: var(--glyph-gold);
        }

        /* Sticky Footer Navigation */
        .nav-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: var(--footer-total-height);
            padding-bottom: var(--footer-safe);
            background: linear-gradient(to bottom, var(--footer-top) 0%, var(--footer-mid) 45%, var(--footer-bottom) 100%);
            border-top: 1px solid rgba(0, 0, 0, 0.55);
            border-bottom: 1px solid rgba(0, 0, 0, 0.85);
            box-shadow: 0 -10px 18px -10px rgba(0, 0, 0, 0.65), inset 0 -6px 14px -10px rgba(0, 0, 0, 0.45);
            z-index: 1200;
            opacity: 0;
            transition: opacity 0.5s ease-in;
        }

        .nav-footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: rgba(201, 169, 97, 0.35);
            pointer-events: none;
        }

        .nav-footer.fade-in {
            opacity: 1;
        }

        .nav-footer-inner {
            max-width: 900px;
            margin: 0 auto;
            height: var(--footer-height);
            padding: 0 10px;
            display: grid;
            grid-template-columns: 100px 1fr 100px;
            align-items: center;
        }

        .nav-center {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0;
            align-self: stretch;
            height: 100%;
        }

        /* Navigation Buttons - Base Styles */
        .nav-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 100%;
            padding: 0;
            border: none;
            background: transparent;
            font-size: 1.8rem;
            color: var(--glyph-gold);
            cursor: pointer;
            transition: color 0.2s ease, text-shadow 0.2s ease, filter 0.2s ease;
            text-decoration: none;
            -webkit-tap-highlight-color: transparent;
            position: relative;
        }

        .nav-btn:hover:not(:disabled),
        .nav-btn:focus-visible:not(:disabled) {
            color: #f5d98c;
            text-shadow: 0 0 8px rgba(201, 169, 97, 0.28);
        }

        .nav-btn:active:not(:disabled) {
            filter: brightness(0.96);
        }

        .nav-btn:disabled {
            opacity: 0.25;
            cursor: not-allowed;
        }

        /* Arrow Buttons - Borders */
        .nav-btn:not(.center)::before {
            content: '';
            position: absolute;
            inset: 12px;
            border: 1px solid #571619;
            border-radius: 4px;
            box-shadow: inset 0 0 12px rgba(0, 0, 0, 0.95);
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            pointer-events: none;
        }

        .nav-btn:not(.center):hover::before,
        .nav-btn:not(.center):focus-visible::before {
            border-color: #6a1f20;
            box-shadow: inset 0 0 14px rgba(0, 0, 0, 0.95);
        }

        .nav-btn:not(.center):disabled::before {
            border-color: rgba(87, 22, 25, 0.15);
            box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.7);
        }

        /* Arrow Buttons - Background */
        .nav-btn:not(.center)::after {
            content: '';
            position: absolute;
            inset: 12px;
            border-radius: 4px;
            z-index: -1;
            transition: background 0.2s ease;
            pointer-events: none;
            background: linear-gradient(to bottom, rgba(255, 232, 180, 0.10) 0%, rgba(0, 0, 0, 0.34) 100%);
        }

        .nav-btn:not(.center):hover::after,
        .nav-btn:not(.center):focus-visible::after {
            background: linear-gradient(to bottom, rgba(255, 232, 180, 0.14) 0%, rgba(0, 0, 0, 0.30) 100%);
        }

        .nav-btn:not(.center):disabled::after {
            background: linear-gradient(to bottom, rgba(255, 232, 180, 0.06) 0%, rgba(0, 0, 0, 0.26) 100%);
        }

        .nav-btn-icon {
            font-size: 1.55rem;
            line-height: 1;
            pointer-events: none;
        }

        .nav-btn-icon.nav-btn-icon--arrow {
            display: inline-block;
            transform: scale(1.08);
            transform-origin: center;
        }

        /* Right column: Next button with label OUTSIDE the frame */
        .nav-next {
            height: 100%;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            text-decoration: none;
            -webkit-tap-highlight-color: transparent;
        }

        .nav-next-frame {
            position: relative;
            width: 74px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--glyph-gold);
            transition: color 0.2s ease, text-shadow 0.2s ease, filter 0.2s ease;
            z-index: 0;
        }

        .nav-next-frame::before {
            content: '';
            position: absolute;
            inset: 0;
            border: 1px solid #571619;
            border-radius: 4px;
            box-shadow: inset 0 0 12px rgba(0, 0, 0, 0.95);
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            pointer-events: none;
        }

        .nav-next-frame::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 4px;
            z-index: -1;
            transition: background 0.2s ease;
            pointer-events: none;
            background: linear-gradient(to bottom, rgba(255, 232, 180, 0.10) 0%, rgba(0, 0, 0, 0.34) 100%);
        }

        .nav-next:hover .nav-next-frame,
        .nav-next:focus-visible .nav-next-frame {
            color: #f5d98c;
            text-shadow: 0 0 8px rgba(201, 169, 97, 0.28);
        }

        .nav-next:hover .nav-next-frame::before,
        .nav-next:focus-visible .nav-next-frame::before {
            border-color: #6a1f20;
            box-shadow: inset 0 0 14px rgba(0, 0, 0, 0.95);
        }

        .nav-next:hover .nav-next-frame::after,
        .nav-next:focus-visible .nav-next-frame::after {
            background: linear-gradient(to bottom, rgba(255, 232, 180, 0.14) 0%, rgba(0, 0, 0, 0.30) 100%);
        }

        .nav-next:active .nav-next-frame {
            filter: brightness(0.96);
        }

        .nav-next-label {
            font-family: 'Cormorant Garamond', serif;
            font-size: 0.62rem;
            font-weight: 600;
            letter-spacing: 0.09em;
            text-transform: uppercase;
            color: var(--footer-label);
            text-shadow: 0 1px 0 rgba(0, 0, 0, 0.85);
            line-height: 1;
            user-select: none;
            white-space: nowrap;
            -webkit-font-smoothing: antialiased;
            text-rendering: optimizeLegibility;
        }

        .nav-next:hover .nav-next-label,
        .nav-next:focus-visible .nav-next-label {
            color: var(--footer-label-hover);
        }

        .nav-next .nav-btn-icon--arrow {
            transform: scale(1.16);
        }

        /* Lexicon Button - Center */
        .nav-btn.center {
            width: 74px;
            height: 44px;
            padding: 0;
            max-width: none;
            font-size: 1.75rem;
            white-space: nowrap;
            line-height: 1;
            font-family: 'Noto Sans Symbols 2', 'Noto Sans Symbols', 'Segoe UI Symbol', 'Apple Symbols', 'Lora', serif;
            transform: translateY(calc(-1 * var(--lexicon-frame-raise)));
        }

        .nav-btn.center::before {
            content: '';
            position: absolute;
            inset: 0;
            border: 1px solid #571619;
            border-radius: 4px;
            box-shadow: inset 0 0 12px rgba(0, 0, 0, 0.95);
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            pointer-events: none;
        }

        .nav-btn.center:hover::before,
        .nav-btn.center:focus-visible::before {
            border-color: #6a1f20;
            box-shadow: inset 0 0 14px rgba(0, 0, 0, 0.95);
        }

        .nav-btn.center::after {
            content: '';
            position: absolute;
            inset: 0;
            background-color: var(--glyph-red);
            border-radius: 4px;
            z-index: -1;
            transition: background-color 0.2s ease;
            pointer-events: none;
        }

        .nav-btn.center:hover::after,
        .nav-btn.center:focus-visible::after {
            background-color: #7a2929;
        }

        /* Lexicon Button - Active State */
        .nav-btn.center.has-selection {
            color: #e8c782;
            text-shadow: 0 0 8px rgba(201, 169, 97, 0.32), 0 0 14px rgba(201, 169, 97, 0.18);
        }

        .nav-btn.center.has-selection::before {
            transform: translateY(-1px);
            box-shadow: inset 0 0 14px rgba(0, 0, 0, 0.95),
                        inset 0 0 10px rgba(201, 169, 97, 0.22),
                        inset 0 0 20px 3px rgba(201, 169, 97, 0.22),
                        inset 0 0 32px 8px rgba(201, 169, 97, 0.1),
                        0 0 14px rgba(0, 0, 0, 0.82);
        }

        .nav-btn.center.has-selection::after {
            background-color: #5f1b1b;
            transform: translateY(-1px);
        }

        /* Lexicon Overlay */
        .lexicon-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.25s ease, visibility 0.25s ease;
            z-index: 700;
        }

        .lexicon-overlay.is-open {
            opacity: 1;
            visibility: visible;
        }

        /* Lexicon Panel */
        .lexicon-panel {
            position: fixed;
            top: 0;
            right: 0;
            height: 100vh;
            width: min(360px, 90vw);
            background-color: #1a1a1a;
            border-left: 1px solid #3a3a3a;
            box-shadow: none;
            transform: translateX(100%);
            transition: transform 0.3s ease, box-shadow 0.3s ease, opacity 2.5s ease-in;
            z-index: 1100;
            display: flex;
            flex-direction: column;
            padding: 24px 20px;
            opacity: 0;
            overscroll-behavior: contain;
        }

        .lexicon-panel.fade-in {
            opacity: 1;
        }

        .lexicon-panel.is-open {
            transform: translateX(0);
            box-shadow: -2px 0 12px rgba(0, 0, 0, 0.5);
        }

        .lexicon-panel.is-dragging {
            transition: none !important;
        }

        .lexicon-drag-region {
            display: none;
            width: 100%;
            justify-content: center;
            align-items: center;
            padding: 4px 0 10px;
            margin: -10px 0 8px;
            user-select: none;
            cursor: grab;
            touch-action: none;
        }

        .lexicon-drag-pill {
            width: 76px;
            height: 4px;
            border-radius: 999px;
            background: rgba(210, 191, 150, 0.58);
            transform: translateY(-2px);
            box-shadow: 0 0 8px rgba(201, 169, 97, 0.14), 0 0 16px rgba(0, 0, 0, 0.75);
            transition: box-shadow 0.18s ease, background-color 0.18s ease, transform 0.18s ease;
        }

        .lexicon-drag-pill.is-pressed {
            background: rgba(210, 191, 150, 0.82);
            box-shadow: 0 0 0 1px rgba(201, 169, 97, 0.38),
                        0 0 18px rgba(201, 169, 97, 0.22),
                        0 0 22px rgba(0, 0, 0, 0.85);
            transform: translateY(-2px) scaleX(1.02);
        }

        .lexicon-panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .lexicon-panel-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.4rem;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: var(--glyph-gold);
        }

        .lexicon-panel-mode {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: #b8986a;
            margin-top: 4px;
        }

        .lexicon-panel-close {
            border: none;
            background: transparent;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--glyph-gold);
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: color 0.2s ease, background-color 0.18s ease, box-shadow 0.18s ease, text-shadow 0.18s ease;
            -webkit-tap-highlight-color: transparent;
        }

        .lexicon-panel-close:hover,
        .lexicon-panel-close:focus-visible {
            color: #e0bf7a;
        }

        .lexicon-panel-close.is-pressed {
            color: #f5d98c;
            background: rgba(201, 169, 97, 0.10);
            box-shadow: 0 0 0 1px rgba(201, 169, 97, 0.28),
                        0 0 16px rgba(201, 169, 97, 0.18);
            text-shadow: 0 0 10px rgba(201, 169, 97, 0.22);
        }

        .lexicon-panel-body {
            font-size: 0.95rem;
            color: #d4d4d4;
            line-height: 1.6;
            flex: 1 1 auto;
            overflow-y: auto;
            padding-right: 12px;
            scrollbar-width: thin;
            scrollbar-color: var(--glyph-gold) #555;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: contain;
            touch-action: pan-y;
        }

        .lexicon-panel-body::-webkit-scrollbar {
            width: 10px;
        }

        .lexicon-panel-body::-webkit-scrollbar-track {
            background: #555;
        }

        .lexicon-panel-body::-webkit-scrollbar-thumb {
            background: var(--glyph-gold);
        }

        .lexicon-panel-body::-webkit-scrollbar-thumb:hover {
            background: #d4b070;
        }

        .lexicon-panel-body p {
            padding-right: 20px;
        }

        .lexicon-panel-body p + p {
            margin-top: 0.9rem;
        }

        .lexicon-sentence-quote {
            font-size: 0.88rem;
            font-style: italic;
            color: #a8a8a8;
            margin-bottom: 1rem;
            padding: 0.6rem 1rem;
            background: #262626;
            border-left: 2px solid var(--glyph-gold);
            line-height: 1.5;
        }

        .lexicon-link {
            display: inline-block;
            margin-top: 1.2rem;
            padding: 0.5rem 1.2rem;
            border-radius: 2px;
            border: 1px solid var(--glyph-gold);
            color: var(--glyph-gold);
            text-decoration: none;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            font-size: 0.8rem;
            transition: background-color 0.2s ease, color 0.2s ease;
            background-color: #262626;
        }

        .lexicon-link:hover,
        .lexicon-link:focus-visible {
            background-color: var(--glyph-gold);
            color: #1a1a1a;
        }

        .lexicon-glossary-footer {
            margin-top: 1.6rem;
            padding-top: 1rem;
            border-top: 1px solid #3a3a3a;
            font-size: 0.85rem;
        }

        .lexicon-glossary-footer h3 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1rem;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            margin-bottom: 0.6rem;
            color: var(--glyph-gold);
        }

        .lexicon-term-list {
            list-style: none;
        }

        .lexicon-term-list li + li {
            margin-top: 0.5rem;
        }

        .lexicon-term-label {
            font-weight: 600;
            color: #e0bf7a;
        }

        .lexicon-term-ref {
            font-size: 0.75rem;
            vertical-align: super;
            color: var(--glyph-gold);
            margin-left: 2px;
        }

        /* Media Queries */
        @media print {
            #loadingIcon,
            #blackFadeOverlay,
            .nav-footer,
            .lexicon-panel,
            .lexicon-overlay {
                display: none !important;
            }

            html,
            body {
                background-color: white;
            }

            body {
                padding: 0;
            }

            .container {
                padding: 0;
                opacity: 1 !important;
            }

            .tooltip {
                display: none;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 20px 10px calc(var(--footer-height) + 30px + var(--footer-safe));
                font-size: 15px;
            }

            .container {
                padding: 30px 20px;
            }

            h1 {
                font-size: 1.8em;
            }

            #loadingIcon {
                font-size: 36px;
            }

            .tooltip {
                max-width: 240px;
            }

            .nav-btn {
                font-size: 1.5rem;
            }

            .nav-btn.center {
                width: 66px;
                height: 40px;
                font-size: 1.6rem;
            }

            .nav-btn-icon {
                font-size: 1.4rem;
            }

            .nav-next-frame {
                width: 66px;
                height: 40px;
            }

            .nav-next-label {
                font-size: 0.60rem;
                letter-spacing: 0.085em;
            }
        }

        @media (max-width: 600px) {
            .lexicon-drag-region {
                display: flex;
                padding: 12px 0 14px;
                margin: -14px 0 6px;
                min-height: 44px;
            }

            .lexicon-drag-pill {
                width: 86px;
                height: 5px;
            }

            .lexicon-panel-close {
                width: 44px;
                height: 44px;
                font-size: 2rem;
            }

            .lexicon-panel {
                top: auto;
                bottom: var(--footer-total-height);
                right: 0;
                left: 0;
                width: 100vw;
                height: 82vh;
                max-height: calc(100vh - var(--footer-total-height));
                border-left: none;
                border-top: 1px solid #3a3a3a;
                border-radius: 12px 12px 0 0;
                transform: translateY(100%);
                z-index: 800;
            }

            .lexicon-panel.is-open {
                transform: translateY(0);
                box-shadow: 0 -2px 12px rgba(0, 0, 0, 0.5);
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 20px 15px;
            }

            h1 {
                font-size: 1.5em;
                letter-spacing: 1px;
            }

            .ornament {
                font-size: 20px;
                letter-spacing: 8px;
            }

            #loadingIcon {
                font-size: 32px;
            }

            .tooltip {
                max-width: 200px;
            }

            .nav-btn {
                font-size: 1.3rem;
            }

            .nav-btn.center {
                width: 62px;
                height: 38px;
                font-size: 1.45rem;
            }

            .nav-btn-icon {
                font-size: 1.25rem;
            }

            .nav-next-frame {
                width: 62px;
                height: 38px;
            }

            .nav-next-label {
                font-size: 0.58rem;
                letter-spacing: 0.08em;
            }
        }

        @media (max-width: 360px) {
            .nav-footer-inner {
                grid-template-columns: 86px 1fr 86px;
            }

            .nav-next-frame {
                width: 58px;
                height: 36px;
            }

            .nav-btn.center {
                width: 58px;
                height: 36px;
                font-size: 1.35rem;
            }
        }
    </style>
</head>
<body>
    <div id="loadingIcon">÷é</div>
    <div id="blackFadeOverlay"></div>

    <div class="container">
        <div class="section-header">
            <div class="ornament">‚ú¶ ‚úß ‚ú¶</div>
            <h1>Invocation and Preamble</h1>
            <div class="ornament">‚ú¶ ‚úß ‚ú¶</div>
        </div>

        <section id="invocation">
            <p class="preamble">
                <span class="sentence" data-lexicon-key="I.1" data-sentence-text="Let silence bear witness before the first word is spoken, that every word thereafter invoke the order of the stars‚Äîunder witness of the Earth.">
                    <span class="sentence-label">1</span>
                    Let silence bear witness before the first word is spoken, that every word thereafter invoke the order of the&nbsp;stars‚Äîunder witness of&nbsp;the&nbsp;Earth.
                </span>
            </p>

            <p>
                <span class="sentence" data-lexicon-key="I.2" data-sentence-text="For hierarchy is no creation of man, but a mirror of the firmament: as command descends through the Lord, so obedience ascends through the Faithful.">
                    <span class="sentence-label">2</span>
                    For
                    <span class="glossary-term">hierarchy<span class="glossary-ref">[3]</span><span class="tooltip">The sacred ordering of authority and obedience.</span></span>
                    is no creation of man, but a mirror of the firmament: as
                    <span class="glossary-term">command<span class="glossary-ref">[4]</span><span class="tooltip">An authoritative directive given by the Lord.</span></span>
                    descends through the Lord, so
                    <span class="glossary-term">obedience<span class="glossary-ref">[5]</span><span class="tooltip">The willing submission and faithful execution of commands.</span></span>
                    ascends through&nbsp;the
                    <span class="glossary-term">Faithful<span class="glossary-ref">[1]</span><span class="tooltip">The devoted servant and obedient instrument within this sacred bond.</span></span>.
                </span>
            </p>

            <p>
                <span class="sentence" data-lexicon-key="I.3" data-sentence-text="Thereby all who swear falsely desecrate not only trust but the very sanctity of oath itself‚Äîthe sacred order upon which all rightful bonds depend.">
                    <span class="sentence-label">3</span>
                    Thereby all who swear falsely desecrate not only trust but the very sanctity of oath itself‚Äîthe sacred order upon which all rightful bonds&nbsp;depend.
                </span>
            </p>

            <p>
                <span class="sentence" data-lexicon-key="I.4" data-sentence-text="Let deceit remain unspoken, avarice cast into the void, and word and spirit be as one.">
                    <span class="sentence-label">4</span>
                    Let deceit remain unspoken, avarice cast into the void, and word and spirit be as&nbsp;one.
                </span>
                <span class="sentence" data-lexicon-key="I.5" data-sentence-text="Thus shall the Covenant endure, an everlasting reflection of divine allegiance.">
                    <span class="sentence-label">5</span>
                    Thus shall the
                    <span class="glossary-term">Covenant<span class="glossary-ref">[2]</span><span class="tooltip">A sacred, binding agreement between the Lord and the Faithful.</span></span>
                    endure, an everlasting reflection of divine&nbsp;allegiance.
                </span>
            </p>

            <div class="section-divider">‚ú¶ ‚úß ‚ú¶</div>
        </section>
    </div>

    <nav class="nav-footer" id="navFooter" aria-label="Covenant navigation">
        <div class="nav-footer-inner">
            <button class="nav-btn" disabled aria-label="Previous section"><span class="nav-btn-icon nav-btn-icon--arrow" aria-hidden="true">‚ùÆ</span></button>

            <div class="nav-center">
                <button class="nav-btn center" id="lexiconToggle" type="button" aria-label="Open Lexicon" aria-expanded="false" aria-controls="lexiconPanel">ìêÜ ñ§ì ìêÜ</button>
            </div>

            <a href="foundation.html" class="nav-next" aria-label="Next: Foundation">
                <span class="nav-next-frame" aria-hidden="true">
                    <span class="nav-btn-icon nav-btn-icon--arrow" aria-hidden="true">‚ùØ</span>
                </span>
                <span class="nav-next-label" aria-hidden="true">Foundation</span>
            </a>
        </div>
    </nav>

    <div class="lexicon-overlay" id="lexiconOverlay" aria-hidden="true"></div>

    <div class="lexicon-panel" id="lexiconPanel" aria-hidden="true" tabindex="-1">
        <div class="lexicon-drag-region" id="lexiconDragRegion" aria-hidden="true">
            <div class="lexicon-drag-pill"></div>
        </div>

        <div class="lexicon-panel-header">
            <div>
                <div class="lexicon-panel-title">Lexicon</div>
                <div class="lexicon-panel-mode">Invocation and Preamble</div>
            </div>
            <button class="lexicon-panel-close" type="button" aria-label="Close Lexicon panel">√ó</button>
        </div>
        <div class="lexicon-panel-body">
            <div id="lexiconDynamicContent">
                <p>
                    This opening passage marks the ceremonial threshold where three authorities are called to witness‚Äîsilence (formless void), stars (celestial realm), Earth (material plane). The celestial order (‚Äúmirror of the firmament‚Äù) is then reflected in the structure of the bond: Lord-Covenant-Faithful, where the Covenant is mediator between Lord and&nbsp;Faithful.
                </p>
                <div class="section-divider">‚ú¶</div>
                <p>
                    The preamble then unfolds in four movements‚Äîordination, admonition, purification, declaration‚Äîestablishing structure, condemning falsification, expelling corruption, and sealing the binding force. All that follows‚ÄîDoctrinal Foundation, Articles, Rituals, the Oath‚Äîflows out from this cosmic&nbsp;frame.
                </p>
            </div>

            <a href="lexicon.html" target="_blank" rel="noopener" class="lexicon-link">Open Full Lexicon</a>

            <div class="lexicon-glossary-footer" aria-label="Glossary terms on this page">
                <h3>Terms in this section</h3>
                <ul class="lexicon-term-list">
                    <li><span class="lexicon-term-label">Faithful</span><span class="lexicon-term-ref">[1]</span> ‚Äì The devoted servant and obedient instrument within this sacred bond.</li>
                    <li><span class="lexicon-term-label">Covenant</span><span class="lexicon-term-ref">[2]</span> ‚Äì A sacred, binding agreement between the Lord and the Faithful.</li>
                    <li><span class="lexicon-term-label">Hierarchy</span><span class="lexicon-term-ref">[3]</span> ‚Äì The sacred ordering of authority and obedience.</li>
                    <li><span class="lexicon-term-label">Command</span><span class="lexicon-term-ref">[4]</span> ‚Äì An authoritative directive given by the Lord.</li>
                    <li><span class="lexicon-term-label">Obedience</span><span class="lexicon-term-ref">[5]</span> ‚Äì The willing submission and faithful execution of commands.</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
    (function() {
        'use strict';
        
        var loadingIcon = document.getElementById('loadingIcon');
        var overlay = document.getElementById('blackFadeOverlay');
        var container = document.querySelector('.container');
        var navFooter = document.getElementById('navFooter');
        var panel = document.getElementById('lexiconPanel');
        var lexiconToggle = document.getElementById('lexiconToggle');
        var lexOverlay = document.getElementById('lexiconOverlay');
        var dynamicContent = document.getElementById('lexiconDynamicContent');
        var defaultOverviewHTML = dynamicContent ? dynamicContent.innerHTML : '';
        var currentlySelectedSentence = null;
        var currentlyActiveTooltip = null;
        var focusReturnEl = null;
        var scrollLockY = 0;

        var isMobileGlyphMode = window.matchMedia && window.matchMedia('(hover: none), (pointer: coarse)').matches;

        function isBottomSheetMode() {
            return window.matchMedia && window.matchMedia('(max-width: 600px)').matches;
        }

        function lockBodyScroll() {
            if (document.documentElement.classList.contains('lexicon-scroll-lock')) return;
            scrollLockY = window.scrollY || window.pageYOffset || 0;
            document.documentElement.classList.add('lexicon-scroll-lock');
            document.body.classList.add('lexicon-scroll-lock');
            document.body.style.top = (-scrollLockY) + 'px';
        }

        function unlockBodyScroll() {
            if (!document.documentElement.classList.contains('lexicon-scroll-lock')) return;
            document.documentElement.classList.remove('lexicon-scroll-lock');
            document.body.classList.remove('lexicon-scroll-lock');
            document.body.style.top = '';
            window.scrollTo(0, scrollLockY);
        }

        function clearActiveTooltip() {
            if (!currentlyActiveTooltip) return;
            currentlyActiveTooltip.classList.remove('tooltip-active');
            currentlyActiveTooltip = null;
        }

        function bindActivate(el, handler) {
            if (!el) return;
            var lastPointerUpAt = 0;

            el.addEventListener('pointerup', function(e) {
                if (e.pointerType === 'mouse' && e.button !== 0) return;
                lastPointerUpAt = Date.now();
                handler(e);
            });

            el.addEventListener('click', function(e) {
                if (Date.now() - lastPointerUpAt < 700) return;
                handler(e);
            });
        }

        function applyPressFeedback(el) {
            if (!el) return;

            function add() { el.classList.add('is-pressed'); }
            function remove() { el.classList.remove('is-pressed'); }

            if (window.PointerEvent) {
                el.addEventListener('pointerdown', add);
                el.addEventListener('pointerup', function() {
                    setTimeout(remove, 160);
                });
                el.addEventListener('pointercancel', remove);
                el.addEventListener('pointerleave', remove);
            } else {
                el.addEventListener('touchstart', add, {passive: true});
                el.addEventListener('touchend', function() {
                    setTimeout(remove, 160);
                }, {passive: true});
                el.addEventListener('touchcancel', remove, {passive: true});
            }
        }

        var lexiconHovering = false;
        var LEX_GLYPHS = {
            default: 'ìêÜ ñ§ì ìêÜ',
            defaultHover: '‚Üø‚óå‚Üæ',
            selected: '‚åØ ñ§ì ‚åØ',
            selectedHover: '‚åØ ñ§ì ‚åØ',
            openSummary: '‚â°‚¶ø‚â°',
            openSelected: '‚ñ∏ñ§ì‚óÇ',
            openHover: '‚áÉ‚åµ‚áÇ',
            mobileOpen: '‚áÉ‚åµ‚áÇ'
        };

        function setLexiconGlyph() {
            if (!lexiconToggle || !panel) return;

            var isOpen = panel.classList.contains('is-open');
            var hasSelection = !!currentlySelectedSentence;

            if (isMobileGlyphMode) {
                lexiconToggle.textContent = isOpen ? LEX_GLYPHS.mobileOpen : (hasSelection ? LEX_GLYPHS.selected : LEX_GLYPHS.default);
                return;
            }

            var glyph;
            if (isOpen) {
                glyph = lexiconHovering ? LEX_GLYPHS.openHover : (hasSelection ? LEX_GLYPHS.openSelected : LEX_GLYPHS.openSummary);
            } else {
                glyph = lexiconHovering ? (hasSelection ? LEX_GLYPHS.selectedHover : LEX_GLYPHS.defaultHover) : (hasSelection ? LEX_GLYPHS.selected : LEX_GLYPHS.default);
            }
            lexiconToggle.textContent = glyph;
        }

        var sentenceExplanations = {
            'I.1': 'The Invocation solves a structural problem: how to establish hierarchy without reducing it to human claim. Three authorities are summoned in descending order‚Äîsilence (void above all), stars (celestial pattern), Earth (terrestrial witness)‚Äîembodying the vertical structure before naming it. This makes ordination, admonition, purification, and declaration possible: each operates within cosmic framework already enacted. Without this opening, the preamble begins with assertion requiring justification. With witness invoked, subsequent language becomes ritual recognition within pre-existing sacred order.',
            'I.2': 'This passage ordains the structure of the Covenant in reflection of the invocation. "Mirror of the firmament" refers to the celestial order in the opening passage‚Äîthe hierarchy as an existing architecture is directly called to witness before any declarations are made. The hierarchy is already sanctified: the void (Lord), the firmament (Covenant as mediator), the Earth (Faithful). No judge can assert what a witness has proclaimed, because it is already established as-it-is. This transforms the bond from temporal contract into holy sacrament within a pre-existing cosmic order.',
            'I.3': 'This passage of admonition outlines the toll of swearing falsely. "Thereby" creates logical chain: because the structure mirrors the firmament, fabricating oath is desecration of the cosmic plane itself. The passage escalates‚Äîbetrayal of bond, violation of oath, profanation of order. To swear falsely is to weaponize the fulcrum keeping everything intact. Because witness was invoked and the order sanctified, oath-breaking becomes spiritual transgression, not merely breach of contract.',
            'I.4': 'Purification responds to Admonition\'s warning by expelling corruption from the threshold. Three corruptions are cast out in sequence: deceit must remain unspoken (false speech banned from the sacred space), avarice must be cast into the void (greed expelled entirely), and word and spirit must become one (interior intention matched to exterior utterance). This is the positive counterpart to the warning‚Äîwhere Admonition says "false oaths desecrate," Purification says "therefore let corruption be expelled and truth unified." The passage ensures that what was invoked, ordained, and protected can now endure. Without purification, the bond rests on contaminated ground; with it, the threshold is sanctified for Declaration.',
            'I.5': 'This passage of declaration seals what the four prior movements have prepared. "Thus" binds the logic: witness invoked, order ordained, profanation warned, corruption expelled‚Äîtherefore the Covenant may endure by right, sustained within the order as established. In calling the Covenant "an everlasting reflection of divine allegiance," the bond is rendered sacred‚Äînot a mere arrangement, but something not to be extinguished.'
        };

        setTimeout(function() {
            if (loadingIcon) loadingIcon.classList.add('fade-out');
            setTimeout(function() {
                overlay.classList.add('fade-out');
                setTimeout(function() {
                    container.classList.add('fade-in');
                    if (navFooter) navFooter.classList.add('fade-in');
                    if (panel) panel.classList.add('fade-in');
                    setTimeout(function() {
                        if (loadingIcon && loadingIcon.parentNode) loadingIcon.parentNode.removeChild(loadingIcon);
                        if (overlay && overlay.parentNode) overlay.parentNode.removeChild(overlay);
                    }, 1500);
                }, 1500);
            }, 500);
        }, 1800);

        function updateLexiconButtonState() {
            if (!lexiconToggle) return;
            lexiconToggle.classList.toggle('has-selection', !!currentlySelectedSentence);
            setLexiconGlyph();
        }

        function resetPanelInlineMotion() {
            if (!panel) return;
            panel.classList.remove('is-dragging');
            panel.style.transform = '';
            panel.style.transition = '';
            if (lexOverlay) lexOverlay.style.opacity = '';
        }

        function focusIntoPanel() {
            if (!panel) return;
            var closeBtn = panel.querySelector('.lexicon-panel-close');
            if (closeBtn && closeBtn.focus) {
                closeBtn.focus();
            } else if (panel.focus) {
                panel.focus();
            }
        }

        function openPanel() {
            if (!panel || !lexOverlay) return;
            clearActiveTooltip();
            resetPanelInlineMotion();
            focusReturnEl = lexiconToggle;
            panel.classList.add('is-open');
            lexOverlay.classList.add('is-open');
            panel.setAttribute('aria-hidden', 'false');
            lexOverlay.setAttribute('aria-hidden', 'false');
            if (lexiconToggle) lexiconToggle.setAttribute('aria-expanded', 'true');
            lockBodyScroll();
            setLexiconGlyph();
            setTimeout(focusIntoPanel, 0);
        }

        function closePanel() {
            if (!panel || !lexOverlay) return;
            clearActiveTooltip();
            resetPanelInlineMotion();
            panel.classList.remove('is-open');
            lexOverlay.classList.remove('is-open');
            panel.setAttribute('aria-hidden', 'true');
            lexOverlay.setAttribute('aria-hidden', 'true');
            if (lexiconToggle) lexiconToggle.setAttribute('aria-expanded', 'false');
            unlockBodyScroll();
            setLexiconGlyph();

            setTimeout(function() {
                var target = (focusReturnEl && document.contains(focusReturnEl)) ? focusReturnEl : lexiconToggle;
                if (target && target.focus) target.focus();
                focusReturnEl = null;
            }, 0);
        }

        function renderOverview() {
            if (!dynamicContent) return;
            dynamicContent.style.opacity = '0';
            setTimeout(function() {
                dynamicContent.innerHTML = defaultOverviewHTML;
                dynamicContent.style.opacity = '1';
            }, 150);
        }

        function renderSentenceExplanation(key, sentenceText) {
            if (!dynamicContent) return;
            var explanation = sentenceExplanations[key];
            if (!explanation) {
                renderOverview();
                return;
            }
            dynamicContent.style.opacity = '0';
            setTimeout(function() {
                dynamicContent.innerHTML = '<div class="lexicon-sentence-quote">"' + sentenceText + '"</div><p>' + explanation + '</p>';
                dynamicContent.style.opacity = '1';
            }, 150);
        }

        if (lexiconToggle && panel && lexOverlay) {
            setLexiconGlyph();

            if (!isMobileGlyphMode) {
                ['pointerenter', 'mouseenter', 'focus'].forEach(function(evt) {
                    lexiconToggle.addEventListener(evt, function() {
                        lexiconHovering = true;
                        setLexiconGlyph();
                    });
                });
                ['pointerleave', 'mouseleave', 'blur'].forEach(function(evt) {
                    lexiconToggle.addEventListener(evt, function() {
                        lexiconHovering = false;
                        setLexiconGlyph();
                    });
                });
            }

            applyPressFeedback(lexiconToggle);

            bindActivate(lexiconToggle, function(e) {
                if (panel.classList.contains('is-open')) {
                    closePanel();
                } else {
                    if (currentlySelectedSentence && currentlySelectedSentence.dataset.lexiconKey) {
                        renderSentenceExplanation(currentlySelectedSentence.dataset.lexiconKey, currentlySelectedSentence.dataset.sentenceText);
                    } else {
                        renderOverview();
                    }
                    openPanel();
                }
            });

            bindActivate(lexOverlay, function() {
                closePanel();
            });

            panel.querySelectorAll('.lexicon-panel-close').forEach(function(btn) {
                applyPressFeedback(btn);
                bindActivate(btn, function(e) {
                    if (e && e.preventDefault) e.preventDefault();
                    closePanel();
                });
            });

            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape' && panel.classList.contains('is-open')) {
                    closePanel();
                }
            });
        }

        var dragRegion = document.getElementById('lexiconDragRegion');
        var dragPill = dragRegion ? dragRegion.querySelector('.lexicon-drag-pill') : null;

        if (dragRegion && panel && lexOverlay) {
            var isDragging = false;
            var startY = 0;
            var lastY = 0;
            var lastT = 0;
            var velocity = 0;
            var currentDelta = 0;

            function setPillPressed(on) {
                if (!dragPill) return;
                dragPill.classList.toggle('is-pressed', !!on);
            }

            function getPanelHeight() {
                var rect = panel.getBoundingClientRect();
                return rect && rect.height ? rect.height : 1;
            }

            function beginDrag(clientY) {
                if (!panel.classList.contains('is-open') || !isBottomSheetMode()) return;
                isDragging = true;
                setPillPressed(true);
                startY = clientY;
                lastY = clientY;
                lastT = window.performance && performance.now ? performance.now() : Date.now();
                velocity = 0;
                currentDelta = 0;
                panel.classList.add('is-dragging');
                panel.style.transition = 'none';
            }

            function updateDrag(clientY) {
                if (!isDragging) return;
                currentDelta = clientY - startY;
                if (currentDelta < 0) currentDelta = 0;
                panel.style.transform = 'translateY(' + currentDelta + 'px)';
                var h = getPanelHeight();
                var fade = 1 - (currentDelta / (h * 0.9));
                if (fade < 0) fade = 0;
                if (fade > 1) fade = 1;
                lexOverlay.style.opacity = String(fade);
                var now = window.performance && performance.now ? performance.now() : Date.now();
                var dt = now - lastT;
                if (dt > 0) velocity = (clientY - lastY) / dt;
                lastY = clientY;
                lastT = now;
            }

            function endDrag() {
                if (!isDragging) return;
                setPillPressed(false);
                var h = getPanelHeight();
                var threshold = Math.max(120, h * 0.25);
                var shouldClose = (currentDelta > threshold) || (velocity > 0.9);
                isDragging = false;
                if (shouldClose) {
                    closePanel();
                } else {
                    panel.classList.remove('is-dragging');
                    panel.style.transition = '';
                    panel.style.transform = '';
                    lexOverlay.style.opacity = '';
                }
            }

            function cancelDrag() {
                setPillPressed(false);
                isDragging = false;
            }

            if (window.PointerEvent) {
                dragRegion.addEventListener('pointerdown', function(e) {
                    beginDrag(e.clientY);
                    try { dragRegion.setPointerCapture(e.pointerId); } catch (err) {}
                });
                dragRegion.addEventListener('pointermove', function(e) {
                    updateDrag(e.clientY);
                });
                dragRegion.addEventListener('pointerup', endDrag);
                dragRegion.addEventListener('pointercancel', function() {
                    cancelDrag();
                    endDrag();
                });
            } else {
                dragRegion.addEventListener('touchstart', function(e) {
                    if (!e.touches || !e.touches[0]) return;
                    beginDrag(e.touches[0].clientY);
                }, {passive: true});
                dragRegion.addEventListener('touchmove', function(e) {
                    if (!e.touches || !e.touches[0]) return;
                    updateDrag(e.touches[0].clientY);
                }, {passive: true});
                dragRegion.addEventListener('touchend', endDrag);
                dragRegion.addEventListener('touchcancel', function() {
                    cancelDrag();
                    endDrag();
                });
            }
        }

        function clearSentenceSelection() {
            if (currentlySelectedSentence) {
                currentlySelectedSentence.classList.remove('is-selected');
                currentlySelectedSentence = null;
                updateLexiconButtonState();
            }
        }

        function handleSentenceClick(node) {
            if (currentlySelectedSentence === node) {
                clearSentenceSelection();
            } else {
                clearSentenceSelection();
                currentlySelectedSentence = node;
                node.classList.add('is-selected');
                updateLexiconButtonState();
            }
        }

        var sentenceNodes = document.querySelectorAll('.sentence');
        sentenceNodes.forEach(function(node) {
            node.addEventListener('click', function(event) {
                event.stopPropagation();
                handleSentenceClick(node);
            });

            var lastTapTime = 0;
            node.addEventListener('touchend', function(event) {
                var currentTime = Date.now();
                var tapLength = currentTime - lastTapTime;
                if (tapLength < 300 && tapLength > 0) {
                    event.preventDefault();
                    event.stopPropagation();
                    handleSentenceClick(node);
                }
                lastTapTime = currentTime;
            });
        });

        function handleOutsideInteraction(event) {
            var isSentence = event.target.closest('.sentence');
            var isLexicon = event.target.closest('#lexiconToggle');
            var isPanel = event.target.closest('#lexiconPanel');
            if (!isSentence && !isLexicon && !isPanel) {
                clearSentenceSelection();
            }
        }

        document.addEventListener('click', handleOutsideInteraction);
        document.addEventListener('touchend', handleOutsideInteraction);

        var glossaryTerms = document.querySelectorAll('.glossary-term');

        glossaryTerms.forEach(function(term) {
            term.addEventListener('touchstart', function(e) {
                if (this === currentlyActiveTooltip) return;
                e.preventDefault();
                clearActiveTooltip();
                this.classList.add('tooltip-active');
                currentlyActiveTooltip = this;
            });
        });

        document.addEventListener('touchstart', function(e) {
            if (!currentlyActiveTooltip) return;
            var touchedGlossaryTerm = Array.from(glossaryTerms).some(function(term) {
                return term.contains(e.target);
            });
            if (!touchedGlossaryTerm) {
                clearActiveTooltip();
            }
        }, {capture: true, passive: true});

        document.addEventListener('touchstart', function(e) {
            if (!currentlySelectedSentence) return;
            var touchedCurrentSentence = currentlySelectedSentence.contains(e.target);
            var touchedLexicon = e.target.closest('#lexiconToggle');
            var touchedPanel = e.target.closest('#lexiconPanel');
            if (!touchedCurrentSentence && !touchedLexicon && !touchedPanel) {
                clearSentenceSelection();
            }
        }, {capture: true, passive: true});
    })();
    </script>
</body>
</html>
