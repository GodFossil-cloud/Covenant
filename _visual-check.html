<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visual Regression Check | Covenant</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:wght@400;600&family=Cormorant+Garamond:wght@400;600&family=Lora:ital,wght@0,400;0,600;1,400&family=Noto+Sans+Symbols+2&display=swap" rel="stylesheet">
    
    <!-- Covenant Styles -->
    <link rel="stylesheet" href="assets/covenant.css">
    
    <style>
        /* Visual check page overrides */
        body {
            padding: 40px 20px 120px;
        }
        
        .check-header {
            max-width: 900px;
            margin: 0 auto 40px;
            padding: 20px;
            background: #1a1a1a;
            color: #f2dc9a;
            border-radius: 4px;
            border-left: 4px solid var(--glyph-gold);
        }
        
        .check-header h1 {
            font-size: 1.5rem;
            margin: 0 0 10px;
            color: #f2dc9a;
            text-transform: none;
        }
        
        .check-header p {
            margin: 0;
            font-size: 0.9rem;
            color: #d4d4d4;
            text-align: left;
        }
        
        .check-section {
            max-width: 900px;
            margin: 0 auto 60px;
            padding: 30px;
            background: var(--bg-color);
            border-radius: 2px;
        }
        
        .check-section h2 {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: var(--primary-color);
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 10px;
        }
        
        .check-description {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 20px;
            font-style: italic;
        }
        
        .check-actions {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
        }
        
        .check-btn {
            display: inline-block;
            padding: 8px 16px;
            margin-right: 10px;
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.2s ease;
        }
        
        .check-btn:hover {
            background: var(--primary-color);
        }
        
        .check-btn.secondary {
            background: #ccc;
            color: #333;
        }
        
        .check-btn.secondary:hover {
            background: #999;
        }
    </style>
</head>
<body>
    <!-- Check Header -->
    <div class="check-header">
        <h1>üîç Visual Regression Check</h1>
        <p>
            Hidden diagnostic page for spot-checking CSS integrity before merges.
            Tests subsection rendering, subpart selection, sentence highlighting, and interactive states.
        </p>
    </div>
    
    <!-- Test 1: Basic Subsection -->
    <div class="check-section">
        <h2>Test 1: Basic Subsection</h2>
        <p class="check-description">
            Single-paragraph subsection. Click to select; should highlight with warm parchment background.
        </p>
        
        <div class="subsection" data-subsection="1">
            <span class="subsection-num">1.</span>
            <span class="subsection-text">
                The Ruby shall honor the sacred journey, walking each threshold with reverence and intentionality, never rushing the unfolding of understanding nor dismissing the wisdom embedded within each passage.
            </span>
        </div>
        
        <div class="check-actions">
            <button class="check-btn" onclick="document.querySelector('[data-subsection=\"1\"]').classList.toggle('is-selected')">Toggle Selection</button>
            <button class="check-btn secondary" onclick="document.querySelector('[data-subsection=\"1\"]').classList.remove('is-selected')">Clear</button>
        </div>
    </div>
    
    <!-- Test 2: Subsection with Subparts -->
    <div class="check-section">
        <h2>Test 2: Subsection with Subparts (‚í∂/‚í∑/‚í∏)</h2>
        <p class="check-description">
            Multi-part subsection. Click individual subparts; each should highlight independently with warm background + subtle border.
        </p>
        
        <div class="subsection has-subparts" data-subsection="2">
            <span class="subsection-num">2.</span>
            <div class="subsection-text">
                <span class="subsection-title">Conditions of Sacred Passage</span>
                <div class="subsection-body">
                    <div class="subpart" data-subpart="2a">
                        <span class="subpart-marker">‚í∂</span>
                        <span class="subpart-content">
                            The Ruby shall approach each gate with empty hands and open heart, releasing all preconception of what lies beyond.
                        </span>
                    </div>
                    <div class="subpart" data-subpart="2b">
                        <span class="subpart-marker">‚í∑</span>
                        <span class="subpart-content">
                            The Ruby shall pause at each threshold, neither rushing forward in eagerness nor retreating in fear, but remaining present to the moment of crossing.
                        </span>
                    </div>
                    <div class="subpart" data-subpart="2c">
                        <span class="subpart-marker">‚í∏</span>
                        <span class="subpart-content">
                            The Ruby shall carry forward the teachings of each passage, allowing them to illuminate the path ahead while honoring their place in the journey behind.
                        </span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="check-actions">
            <button class="check-btn" onclick="document.querySelector('[data-subpart=\"2a\"]').classList.toggle('is-subpart-selected')">Toggle ‚í∂</button>
            <button class="check-btn" onclick="document.querySelector('[data-subpart=\"2b\"]').classList.toggle('is-subpart-selected')">Toggle ‚í∑</button>
            <button class="check-btn" onclick="document.querySelector('[data-subpart=\"2c\"]').classList.toggle('is-subpart-selected')">Toggle ‚í∏</button>
            <button class="check-btn secondary" onclick="document.querySelectorAll('.subpart').forEach(el => el.classList.remove('is-subpart-selected'))">Clear All</button>
        </div>
    </div>
    
    <!-- Test 3: Sentence Selection -->
    <div class="check-section">
        <h2>Test 3: Sentence-Level Selection</h2>
        <p class="check-description">
            Sentences with labels. Click to select; should highlight with subtle box-shadow + warm background.
        </p>
        
        <div class="subsection" data-subsection="3">
            <span class="subsection-num">3.</span>
            <span class="subsection-text">
                <span class="sentence" data-sentence="3-1">
                    <span class="sentence-label">1</span>The Ruby acknowledges that transformation requires both patience and courage.
                </span>
                <span class="sentence" data-sentence="3-2">
                    <span class="sentence-label">2</span>Each threshold crossed becomes part of the Ruby's living archive of wisdom.
                </span>
                <span class="sentence" data-sentence="3-3">
                    <span class="sentence-label">3</span>The journey itself is the teaching, and the teaching is the journey.
                </span>
            </span>
        </div>
        
        <div class="check-actions">
            <button class="check-btn" onclick="document.querySelector('[data-sentence=\"3-1\"]').classList.toggle('is-selected')">Toggle Sentence 1</button>
            <button class="check-btn" onclick="document.querySelector('[data-sentence=\"3-2\"]').classList.toggle('is-selected')">Toggle Sentence 2</button>
            <button class="check-btn" onclick="document.querySelector('[data-sentence=\"3-3\"]').classList.toggle('is-selected')">Toggle Sentence 3</button>
            <button class="check-btn secondary" onclick="document.querySelectorAll('.sentence').forEach(el => el.classList.remove('is-selected'))">Clear All</button>
        </div>
    </div>
    
    <!-- Test 4: Footer Navigation (Static Preview) -->
    <div class="check-section">
        <h2>Test 4: Footer Navigation Elements</h2>
        <p class="check-description">
            Visual inspection of footer controls (see bottom of page). Verify:
        </p>
        <ul style="margin-left: 20px; color: #666;">
            <li>Obsidian background gradient (dark, subtle specular highlight)</li>
            <li>Antique brass arrows (‚óÄ ‚ñ∂) in side frames</li>
            <li>Circular seal in center with ñ§ìñ§ìñ§ì glyphs</li>
            <li>Citation label beneath seal (should display current page/section)</li>
            <li>Cradle highlight (subtle semicircle hairline above seal)</li>
        </ul>
        <p style="color: #999; font-size: 0.85rem; margin-top: 10px;">
            ‚ÑπÔ∏è On mobile: seal should be draggable; panel should slide up from bottom.
        </p>
    </div>
    
    <!-- Footer Navigation (from nav-footer.html pattern) -->
    <footer class="nav-footer fade-in">
        <div class="nav-footer-inner">
            <!-- Previous -->
            <a href="javascript:void(0)" class="nav-prev" aria-label="Previous: Visual Check">
                <div class="nav-prev-frame">
                    <span class="nav-btn-icon nav-btn-icon--arrow">‚óÄ</span>
                </div>
                <span class="nav-prev-label">Check</span>
            </a>
            
            <!-- Center: Lexicon Toggle + Citation -->
            <div class="nav-center">
                <button 
                    id="lexiconToggle" 
                    class="nav-btn center" 
                    aria-label="Open Lexicon" 
                    aria-expanded="false"
                    onclick="alert('Lexicon toggle works! (Full panel not implemented on this static check page.)')">
                    <span class="lexicon-glyph">
                        ñ§ì<span class="lexicon-glyph-mid"><span class="lexicon-glyph-mid-inner">ñ§ì</span></span>ñ§ì
                    </span>
                </button>
                <div class="citation-label">
                    <span class="citation-text">Visual Regression</span>
                </div>
            </div>
            
            <!-- Next -->
            <a href="javascript:void(0)" class="nav-next" aria-label="Next: Visual Check">
                <div class="nav-next-frame">
                    <span class="nav-btn-icon nav-btn-icon--arrow">‚ñ∂</span>
                </div>
                <span class="nav-next-label">Check</span>
            </a>
        </div>
    </footer>
    
    <script>
        // Basic selection handlers (mimics lexicon.js behavior for testing)
        document.querySelectorAll('.subsection').forEach(subsection => {
            subsection.addEventListener('click', (e) => {
                if (e.target.closest('.subpart')) return; // Skip if clicking subpart
                subsection.classList.toggle('is-selected');
            });
        });
        
        document.querySelectorAll('.subpart').forEach(subpart => {
            subpart.addEventListener('click', (e) => {
                e.stopPropagation();
                subpart.classList.toggle('is-subpart-selected');
            });
        });
        
        document.querySelectorAll('.sentence').forEach(sentence => {
            sentence.addEventListener('click', (e) => {
                e.stopPropagation();
                sentence.classList.toggle('is-selected');
            });
        });
        
        // Toggle lexicon button selection state for testing
        let lexiconHasSelection = false;
        document.getElementById('lexiconToggle').addEventListener('contextmenu', (e) => {
            e.preventDefault();
            lexiconHasSelection = !lexiconHasSelection;
            e.target.classList.toggle('has-selection', lexiconHasSelection);
        });
        
        console.log('üîç Visual Regression Check loaded');
        console.log('Right-click lexicon seal to toggle .has-selection state');
    </script>
</body>
</html>
