/* Footer-only override: reshape Lexicon seal (flat top) and seat its top edge where it originally rested.
   Only the ToC/Mirror tabs move; the seal remains at its prior height.

   Scope: #navFooter only (prevents any bleed into reference pages / non-dock contexts).
*/

#navFooter {
  /* Seal seating: raise the flat-top seal so its top edge aligns with the Lexicon panel lip. */
  --lexicon-seal-top-align: 9px;

  /* Cradle seat: lift the cradle highlight/border to trace the seal underside.
     (Baseline was 5px in the legacy fallback; this keeps cradle + seal locked.) */
  --seal-cradle-shift-y: calc(-1 * (var(--lexicon-seal-top-align) - 5px));

  /* Fine adjustment: lower the socket/cutout relative to the seal. */
  --seal-cradle-drop-y: 8px;

  --lexicon-seal-w: 66px;
  --lexicon-seal-h: 40px;

  /* Keep dock window mask math aligned with the actual footer seal cluster spacing.
     (toc.css uses --toc-tab-gap when positioning the animated dock “window” mask.) */
  --toc-tab-gap: 10px;

  /* Footer override forces ToC/Mirror plates to --nav-pill-width; keep the cradle + window math in sync. */
  --toc-tab-width: var(--nav-pill-width);

  /* Dock window mask origin: the center seal is seated higher by --lexicon-seal-top-align, so shift the mask origin to match. */
  --dock-window-origin-x: 50%;
  --dock-window-origin-y: calc(50% - (var(--lexicon-seal-top-align) / 2));

  /* Socket geometry: match the cradle line to the flat-top seal's new width. */
  --seal-notch-radius: calc(var(--lexicon-seal-w) * 0.5);
  --seal-notch-height: calc(var(--seal-notch-radius) + 6px);

  /* Micro-nudges for glyph optical centering (mobile Safari). */
  --toc-glyph-nudge-x: 0px;
  --mirror-glyph-nudge-x: 0px;
}

/* Cutout socket:
   Paint the slab on ::before, then punch the cradle notch out via a mask.
   This makes the cradle interior truly transparent (reads as a carved opening). */
#navFooter {
  background: transparent !important;
  border-top: none !important;
  border-bottom: none !important;
  box-shadow: none !important;
}

#navFooter::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;

  /* Same obsidian slab paint as assets/covenant.css (.nav-footer override block). */
  background:
    /* Hairline: shift up by 2px so it sits exactly on the seam above the footer. */
    linear-gradient(to bottom,
      transparent 0,
      transparent 2px,
      var(--footer-hairline) 2px,
      var(--footer-hairline) 3px,
      transparent 3px,
      transparent 100%
    ),
    radial-gradient(1200px 90px at 50% 0%, rgba(255,255,255,0.06), rgba(255,255,255,0) 55%),
    linear-gradient(to bottom, var(--obsidian-2) 0%, var(--obsidian-1) 45%, var(--obsidian-0) 100%);

  background-position: 0 -2px, 0 0, 0 0;

  border-top: 1px solid rgba(0, 0, 0, 0.70);
  border-bottom: 1px solid rgba(0, 0, 0, 0.92);
  box-shadow:
    0 -14px 22px -14px rgba(0, 0, 0, 0.78),
    inset 0 1px 0 rgba(255,255,255,0.04),
    inset 0 -10px 18px -16px rgba(0,0,0,0.72);

  /* Punch the cradle void (a circle centered near the top edge becomes a semicircle cutout).
     Use white (not black) for the "keep" region so both alpha- and luminance-based mask paths behave. */
  -webkit-mask-image: radial-gradient(circle at 50% calc(0px + var(--seal-cradle-drop-y, 0px)),
    rgba(0,0,0,0) 0 calc(var(--seal-notch-radius) - 0.5px),
    rgba(255,255,255,1) calc(var(--seal-notch-radius) + 0.5px)
  );
  mask-image: radial-gradient(circle at 50% calc(0px + var(--seal-cradle-drop-y, 0px)),
    rgba(0,0,0,0) 0 calc(var(--seal-notch-radius) - 0.5px),
    rgba(255,255,255,1) calc(var(--seal-notch-radius) + 0.5px)
  );
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;
  -webkit-mask-size: 100% 100%;
  mask-size: 100% 100%;
}

/* Cradle border: keep only the tracing line (no interior shading fill). */
#navFooter::after {
  content: '';
  position: absolute;
  left: 0;
  right: 0;
  top: calc(var(--seal-cradle-shift-y, 0px) + var(--seal-cradle-drop-y, 0px));
  height: var(--seal-notch-height);
  pointer-events: none;

  background:
    radial-gradient(circle at 50% 0%,
      transparent 0 calc(var(--seal-notch-radius) - 1px),
      var(--footer-cradle-line) calc(var(--seal-notch-radius)) calc(var(--seal-notch-radius) + 0.75px),
      transparent calc(var(--seal-notch-radius) + 1.6px)
    );

  opacity: 0.95;
}

#navFooter #lexiconToggle,
#navFooter #lexiconToggle::before,
#navFooter #lexiconToggle::after {
  border-radius: 0 0 999px 999px !important;
}

#navFooter #lexiconToggle {
  overflow: hidden;
  margin-top: calc(-1 * var(--lexicon-seal-top-align) + 4px);

  /* Wider + shorter medallion (footer-local only). */
  width: var(--lexicon-seal-w);
  height: var(--lexicon-seal-h);
}

/* Mobile Safari: lock the three-seal cluster into true symmetry so the Lexicon seal reads centered. */
#navFooter .nav-seals {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--toc-tab-gap);
  flex-wrap: nowrap;
}

/* Make ToC and Mirror identical bookends (prevents subtle off-center drift).
   Keep their original plate geometry (no rounding).
   IMPORTANT: do not apply additional margin offsets here; tab/socket alignment is governed by --dock-tab-raise. */
#navFooter #tocToggle,
#navFooter #mirrorToggle {
  width: var(--nav-pill-width);
  height: var(--nav-pill-height);
  padding: 0;
  flex: 0 0 var(--nav-pill-width);
  margin-top: 0;
}

/* Mobile: raise only the tab plates (not the sockets) so they don't overlap the socket's bottom line. */
@media (max-width: 600px) {
  #navFooter {
    --dock-tab-raise: -18px;
    --toc-tab-gap: 8px;
  }
}

/* Prevent the wide seal from flexing or shrinking unexpectedly. */
#navFooter #lexiconToggle {
  flex: 0 0 var(--lexicon-seal-w);
}

/* Ensure the tab glyphs sit on a consistent centering box (optical centering then uses nudges). */
#navFooter #tocToggle .toc-glyph,
#navFooter #mirrorToggle .toc-glyph {
  display: inline-grid;
  place-items: center;
  width: 1em;
  height: 1em;
  line-height: 1;
}

/* IMPORTANT: do not set `transform` here.
   Other layers (critical CSS / toc.css / tab-weld.js) rely on `transform` for true vertical centering.
   Use margin-left for small optical nudges instead. */
#navFooter #tocToggle .toc-glyph {
  margin-left: var(--toc-glyph-nudge-x);
}

#navFooter #mirrorToggle .toc-glyph {
  margin-left: var(--mirror-glyph-nudge-x);
}

/* iOS Safari: seat the *tab plates* into their sockets.
   Use left/right offsets (not transform) so :active press travel still works.

   NOTE: Offsets should push the bookends outward so each medallion sits in its own cradle.
*/
@media (max-width: 600px) {
  #navFooter #tocToggle,
  #navFooter #mirrorToggle { position: relative; }

  #navFooter #tocToggle { left: -3px; }
  #navFooter #mirrorToggle { left: 3px; }
}

/* Option 2: altar-focused emphasis
   - Citation sigil sits close under the seal cluster.
   - Prev/Next labels soften slightly on small screens so the altar leads. */
#navFooter .citation-label {
  margin-top: 4px;
  min-height: 18px;
  display: block !important;
  visibility: visible !important;
}

/* If any global CSS hides empty citation labels, override it footer-locally. */
#navFooter .citation-label:empty {
  display: block !important;
  visibility: visible !important;
}

@media (max-width: 600px) {
  #navFooter .citation-label {
    margin-top: 2px;
    min-height: 16px;
  }

  #navFooter .nav-next-label,
  #navFooter .nav-prev-label {
    font-size: 0.78rem;
    letter-spacing: 0.10em;
    opacity: 0.86;
  }
}

@media (max-width: 480px) {
  #navFooter .nav-next-label,
  #navFooter .nav-prev-label {
    font-size: 0.76rem;
    opacity: 0.8;
  }
}
