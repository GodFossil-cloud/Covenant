/* Lexicon seal cover rules (ui-stack + translucency fix).

   Context:
   - assets/ui-stack.js assigns z-index to modal surfaces starting at Z_BASE=1500.
   - The footer dock remains sovereign (higher z-index) and can visually sit above scrims.
   - When Lexicon is open and another surface (ToC/Reliquary) becomes topmost, ui-stack.js
     toggles `.is-ui-stack-covered` on #lexiconToggle.

   Important update (Option B):
   - The seal may be re-parented into the Lexicon panel header while the panel is open.
     Therefore, cover rules MUST NOT depend on #navFooter ancestry.

   Why hide (not just z-index):
   - ToC/Reliquary overlays are intentionally translucent.
     If the seal is merely "behind" them, it can still be visible through the veil.

   Fix:
   - When covered, fade the seal out, then set visibility:hidden so it cannot read through veils.
   - When uncovered, restore visibility immediately and fade back in.
*/

/* Base: enable a gentle fade without affecting the sealâ€™s existing transform/filters. */
#lexiconToggle{
  transition: opacity 180ms ease;
  will-change: opacity;
}

/* Covered: lower z-index as a backstop, fade out, then flip visibility after the fade. */
#lexiconToggle.is-ui-stack-covered{
  /* Backstop: keep below ui-stack surfaces (Z_BASE=1500). */
  position: relative;
  z-index: 1490 !important;

  opacity: 0 !important;
  pointer-events: none !important;

  /* After the fade completes, remove from paint/AT hit-testing. */
  visibility: hidden !important;
  transition:
    opacity 180ms ease,
    visibility 0s linear 180ms;

  /* Avoid any accidental compositing artifacts. */
  filter: none !important;
}

/* Uncovered: make it visible immediately so opacity can fade back up. */
#lexiconToggle:not(.is-ui-stack-covered){
  visibility: visible;
}
