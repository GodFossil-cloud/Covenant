/*! Covenant ToC Panel Styles v2.1.4 (Parchment Fade) */

.section-header.has-toc-toggle{position:relative}
.section-header.has-toc-toggle h1{transition:text-shadow 220ms ease,filter 220ms ease}
.section-header.toc-title-sheen h1{text-shadow:0 0 14px rgba(201,169,97,.18),0 0 1px rgba(255,255,255,.16);filter:brightness(1.02)}

.toc-toggle{position:absolute;z-index:1500;padding:0;margin:0;border:none;background:transparent;cursor:pointer;pointer-events:auto;-webkit-tap-highlight-color:transparent;touch-action:pan-y;user-select:none;-webkit-user-select:none}
.toc-toggle:focus-visible{outline:2px solid rgba(201,169,97,.45);outline-offset:4px}

.toc-toggle--floating{position:fixed;top:14px;left:14px;width:44px;height:44px;display:inline-grid;place-items:center;color:rgba(44,62,80,.72)}
.toc-toggle-glyph{font-size:1.15rem;line-height:1;transform:translateY(-.5px)}

html.lexicon-scroll-lock .toc-toggle{opacity:0;visibility:hidden;pointer-events:none}

html.toc-scroll-lock{overflow:hidden}
body.toc-scroll-lock{position:fixed;width:100%}

/* Animate the Lexicon seal into a "receded" (locked) posture while the ToC is open.
   NOTE: toc.css is loaded BEFORE covenant.css via _includes/covenant-config.html.
   Use a slightly higher-specificity selector so our transition (incl. opacity) is not overridden on mobile. */
html #lexiconToggle{transition:color 0.2s ease,text-shadow 0.2s ease,filter 0.2s ease,transform var(--lexicon-snap-duration) var(--lexicon-snap-ease),opacity 240ms ease}

/* While the ToC is open, push the seal behind the footer cradle so it "locks" into the dock instead of floating above it. */
html.toc-open #lexiconToggle{z-index:0}
html.toc-open .nav-footer::after{z-index:6}
html.toc-open .nav-footer::before{z-index:6}

/* Micro-glint: a quick "latch click" before the seal recedes (subtle, sacred). */
@keyframes lexiconSealLatchGlint{0%{box-shadow:inset 0 0 18px rgba(0,0,0,.84),inset 0 1px 0 rgba(255,255,255,.05),0 10px 18px -14px rgba(0,0,0,.90),0 14px 10px -12px rgba(0,0,0,.92)}45%{box-shadow:inset 0 0 20px rgba(0,0,0,.90),inset 0 1px 0 rgba(255,255,255,.10),0 0 0 1px rgba(242,220,154,.20),0 0 14px rgba(242,220,154,.12),0 14px 10px -12px rgba(0,0,0,.92)}100%{box-shadow:inset 0 0 18px rgba(0,0,0,.84),inset 0 1px 0 rgba(255,255,255,.05),0 10px 18px -14px rgba(0,0,0,.90),0 14px 10px -12px rgba(0,0,0,.92)}}
@keyframes lexiconSealLatchSurface{0%{background-color:var(--obsidian-1)}45%{background-color:#141418}100%{background-color:var(--obsidian-1)}}

html.toc-open #lexiconToggle::before{animation:lexiconSealLatchGlint 140ms ease-out 1}
html.toc-open #lexiconToggle::after{animation:lexiconSealLatchSurface 140ms ease-out 1}

/* Delay the recede just long enough for the latch glint to read. */
html.toc-open #lexiconToggle{transition-delay:110ms;opacity:0;pointer-events:none;filter:brightness(.92);--seal-seat-nudge:-8px}

@media (prefers-reduced-motion: reduce){html #lexiconToggle{transition:none}html.toc-open #lexiconToggle{transition-delay:0ms}html.toc-open #lexiconToggle::before,html.toc-open #lexiconToggle::after{animation:none}}

.toc-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:1400;opacity:0;pointer-events:none;transition:opacity 340ms cubic-bezier(.22,.61,.36,1)}
.toc-overlay.is-open{opacity:1;pointer-events:auto}

/* Panel: parchment that fades to transparent at the bottom edge. */
.toc-panel{position:fixed;left:50%;top:110px;max-height:70vh;width:min(720px,calc(100vw - 24px));background:linear-gradient(to bottom,rgba(247,244,238,1) 0%,rgba(247,244,238,1) 72%,rgba(247,244,238,0) 100%);border:1px solid rgba(44,62,80,.18);border-bottom-color:transparent;box-shadow:0 22px 60px rgba(0,0,0,.24),0 8px 24px rgba(0,0,0,.14);border-radius:0 0 16px 16px;z-index:1401;opacity:0;transform:translateX(-50%) translateY(-12px);transform-origin:50% 0;transition:transform 340ms cubic-bezier(.22,.61,.36,1),opacity 240ms ease;display:flex;flex-direction:column;overflow:hidden;background-clip:padding-box}
.toc-panel.is-open{opacity:1;transform:translateX(-50%) translateY(0)}
.toc-panel[aria-hidden="true"]{pointer-events:none}
.toc-panel[aria-hidden="false"]{pointer-events:auto}

@supports((-webkit-backdrop-filter:blur(2px)) or (backdrop-filter:blur(2px))){.toc-panel{-webkit-backdrop-filter:none;backdrop-filter:none}}

/* Obsidian crown + hairline brass (echoes footer palette, quietly). */
.toc-panel::before{content:'';position:absolute;top:0;left:0;right:0;height:14px;background:linear-gradient(to bottom,#0b0c0e 0%,#121318 60%,rgba(18,19,24,0) 100%);pointer-events:none}
.toc-panel::after{content:'';position:absolute;top:13px;left:0;right:0;height:1px;background:rgba(201,169,97,.32);pointer-events:none}

.toc-panel-header{position:relative;padding:0;border:0;background:transparent;height:0}
.toc-panel-title,.toc-panel-subtitle{display:none}

/* IMPORTANT: allow vertical scrolling inside the panel body. */
.toc-panel-body{flex:1;overflow-y:auto;overflow-x:hidden;padding:1.25rem 1.5rem 1.45rem;-webkit-overflow-scrolling:touch;overscroll-behavior:contain;touch-action:pan-y;position:relative}

/* Inner grain + vignette for dimensional parchment. */
.toc-panel-body::before{content:'';position:absolute;inset:0;background:radial-gradient(900px 420px at 50% 0%,rgba(201,169,97,.06),rgba(201,169,97,0) 55%),radial-gradient(900px 520px at 50% 120%,rgba(0,0,0,.05),rgba(0,0,0,0) 60%),linear-gradient(to bottom,rgba(255,255,255,.72),rgba(255,255,255,0));pointer-events:none}

/* Remove the bottom fade overlay entirely (it reads as a box on mobile). */
.toc-panel-body::after{content:none}

.toc-panel-body>*{position:relative}

.toc-list{list-style:none;max-width:100%;padding:0;margin:0}
.toc-item{margin:0 0 .55rem;display:flex;justify-content:center;align-items:baseline;max-width:100%}

.toc-item-btn,.toc-locked-btn{display:inline-block;background:none;border:0;padding:0;margin:0;font:inherit;font-size:1rem;line-height:1.6;text-align:center;max-width:100%;white-space:normal;overflow-wrap:anywhere}

.toc-item-btn{color:#2c3e50;border-bottom:1px solid transparent;cursor:pointer;transition:border-color 200ms ease,color 200ms ease}
.toc-item-btn:hover,.toc-item-btn:focus-visible{color:#111;border-bottom-color:rgba(139,115,85,.55)}
.toc-item-btn:focus-visible{outline:2px solid rgba(201,169,97,.38);outline-offset:3px}
.toc-item-btn:disabled{cursor:default;border-bottom-color:transparent}
.toc-item--current .toc-item-btn{font-weight:600;color:#111}

.toc-locked-btn{color:#8a8a8a;cursor:not-allowed}
.toc-locked-btn:focus-visible{outline:2px solid rgba(201,169,97,.26);outline-offset:3px}
.toc-locked-label{font-size:.85rem;font-style:italic;color:#9b9b9b}

/* Mobile-friendly locked feedback (native title tooltips are unreliable on touch devices). */
.toc-toast{position:sticky;bottom:.65rem;margin:.95rem auto 0;width:fit-content;max-width:min(520px,92%);padding:.6rem 1rem;border-radius:999px;background:rgba(11,12,14,.92);color:rgba(245,245,240,.96);font-size:.95rem;letter-spacing:.04em;line-height:1.25;text-align:center;box-shadow:0 14px 30px rgba(0,0,0,.22),0 2px 10px rgba(0,0,0,.12);opacity:0;transform:translateY(6px);pointer-events:none;transition:opacity 420ms ease,transform 180ms ease}
.toc-toast.is-visible{opacity:1;transform:translateY(0)}
@media (prefers-reduced-motion: reduce){.toc-toast{transition:none;transform:none}.toc-toast.is-visible{transform:none}}

@media (max-width:600px){.toc-panel{width:calc(100vw - 18px);border-radius:0 0 14px 14px}.toc-panel-body{padding:1.15rem 1.25rem 1.25rem}}
